(()=>{var ft=Object.create;var rt=Object.defineProperty;var gt=Object.getOwnPropertyDescriptor;var vt=Object.getOwnPropertyNames;var mt=Object.getPrototypeOf,yt=Object.prototype.hasOwnProperty;var pt=(s,t)=>()=>(t||s((t={exports:{}}).exports,t),t.exports);var wt=(s,t,e,a)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of vt(t))!yt.call(s,r)&&r!==e&&rt(s,r,{get:()=>t[r],enumerable:!(a=gt(t,r))||a.enumerable});return s};var bt=(s,t,e)=>(e=s!=null?ft(mt(s)):{},wt(t||!s||!s.__esModule?rt(e,"default",{value:s,enumerable:!0}):e,s));var it=pt((G,Z)=>{(function(s,t){typeof G=="object"&&typeof Z<"u"?Z.exports=t():typeof define=="function"&&define.amd?define(t):(s=typeof globalThis<"u"?globalThis:s||self).dayjs=t()})(G,(function(){"use strict";var s=1e3,t=6e4,e=36e5,a="millisecond",r="second",h="minute",g="hour",m="day",k="week",p="month",Y="quarter",M="year",E="date",et="Invalid Date",dt=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,ct=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,ut={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(d){var o=["th","st","nd","rd"],n=d%100;return"["+d+(o[(n-20)%10]||o[n]||o[0])+"]"}},J=function(d,o,n){var l=String(d);return!l||l.length>=o?d:""+Array(o+1-l.length).join(n)+d},ht={s:J,z:function(d){var o=-d.utcOffset(),n=Math.abs(o),l=Math.floor(n/60),i=n%60;return(o<=0?"+":"-")+J(l,2,"0")+":"+J(i,2,"0")},m:function d(o,n){if(o.date()<n.date())return-d(n,o);var l=12*(n.year()-o.year())+(n.month()-o.month()),i=o.clone().add(l,p),c=n-i<0,u=o.clone().add(l+(c?-1:1),p);return+(-(l+(n-i)/(c?i-u:u-i))||0)},a:function(d){return d<0?Math.ceil(d)||0:Math.floor(d)},p:function(d){return{M:p,y:M,w:k,d:m,D:E,h:g,m:h,s:r,ms:a,Q:Y}[d]||String(d||"").toLowerCase().replace(/s$/,"")},u:function(d){return d===void 0}},O="en",A={};A[O]=ut;var at="$isDayjsObject",K=function(d){return d instanceof P||!(!d||!d[at])},F=function d(o,n,l){var i;if(!o)return O;if(typeof o=="string"){var c=o.toLowerCase();A[c]&&(i=c),n&&(A[c]=n,i=c);var u=o.split("-");if(!i&&u.length>1)return d(u[0])}else{var v=o.name;A[v]=o,i=v}return!l&&i&&(O=i),i||!l&&O},w=function(d,o){if(K(d))return d.clone();var n=typeof o=="object"?o:{};return n.date=d,n.args=arguments,new P(n)},f=ht;f.l=F,f.i=K,f.w=function(d,o){return w(d,{locale:o.$L,utc:o.$u,x:o.$x,$offset:o.$offset})};var P=(function(){function d(n){this.$L=F(n.locale,null,!0),this.parse(n),this.$x=this.$x||n.x||{},this[at]=!0}var o=d.prototype;return o.parse=function(n){this.$d=(function(l){var i=l.date,c=l.utc;if(i===null)return new Date(NaN);if(f.u(i))return new Date;if(i instanceof Date)return new Date(i);if(typeof i=="string"&&!/Z$/i.test(i)){var u=i.match(dt);if(u){var v=u[2]-1||0,y=(u[7]||"0").substring(0,3);return c?new Date(Date.UTC(u[1],v,u[3]||1,u[4]||0,u[5]||0,u[6]||0,y)):new Date(u[1],v,u[3]||1,u[4]||0,u[5]||0,u[6]||0,y)}}return new Date(i)})(n),this.init()},o.init=function(){var n=this.$d;this.$y=n.getFullYear(),this.$M=n.getMonth(),this.$D=n.getDate(),this.$W=n.getDay(),this.$H=n.getHours(),this.$m=n.getMinutes(),this.$s=n.getSeconds(),this.$ms=n.getMilliseconds()},o.$utils=function(){return f},o.isValid=function(){return this.$d.toString()!==et},o.isSame=function(n,l){var i=w(n);return this.startOf(l)<=i&&i<=this.endOf(l)},o.isAfter=function(n,l){return w(n)<this.startOf(l)},o.isBefore=function(n,l){return this.endOf(l)<w(n)},o.$g=function(n,l,i){return f.u(n)?this[l]:this.set(i,n)},o.unix=function(){return Math.floor(this.valueOf()/1e3)},o.valueOf=function(){return this.$d.getTime()},o.startOf=function(n,l){var i=this,c=!!f.u(l)||l,u=f.p(n),v=function(R,S){var x=f.w(i.$u?Date.UTC(i.$y,S,R):new Date(i.$y,S,R),i);return c?x:x.endOf(m)},y=function(R,S){return f.w(i.toDate()[R].apply(i.toDate("s"),(c?[0,0,0,0]:[23,59,59,999]).slice(S)),i)},b=this.$W,D=this.$M,$=this.$D,N="set"+(this.$u?"UTC":"");switch(u){case M:return c?v(1,0):v(31,11);case p:return c?v(1,D):v(0,D+1);case k:var T=this.$locale().weekStart||0,I=(b<T?b+7:b)-T;return v(c?$-I:$+(6-I),D);case m:case E:return y(N+"Hours",0);case g:return y(N+"Minutes",1);case h:return y(N+"Seconds",2);case r:return y(N+"Milliseconds",3);default:return this.clone()}},o.endOf=function(n){return this.startOf(n,!1)},o.$set=function(n,l){var i,c=f.p(n),u="set"+(this.$u?"UTC":""),v=(i={},i[m]=u+"Date",i[E]=u+"Date",i[p]=u+"Month",i[M]=u+"FullYear",i[g]=u+"Hours",i[h]=u+"Minutes",i[r]=u+"Seconds",i[a]=u+"Milliseconds",i)[c],y=c===m?this.$D+(l-this.$W):l;if(c===p||c===M){var b=this.clone().set(E,1);b.$d[v](y),b.init(),this.$d=b.set(E,Math.min(this.$D,b.daysInMonth())).$d}else v&&this.$d[v](y);return this.init(),this},o.set=function(n,l){return this.clone().$set(n,l)},o.get=function(n){return this[f.p(n)]()},o.add=function(n,l){var i,c=this;n=Number(n);var u=f.p(l),v=function(D){var $=w(c);return f.w($.date($.date()+Math.round(D*n)),c)};if(u===p)return this.set(p,this.$M+n);if(u===M)return this.set(M,this.$y+n);if(u===m)return v(1);if(u===k)return v(7);var y=(i={},i[h]=t,i[g]=e,i[r]=s,i)[u]||1,b=this.$d.getTime()+n*y;return f.w(b,this)},o.subtract=function(n,l){return this.add(-1*n,l)},o.format=function(n){var l=this,i=this.$locale();if(!this.isValid())return i.invalidDate||et;var c=n||"YYYY-MM-DDTHH:mm:ssZ",u=f.z(this),v=this.$H,y=this.$m,b=this.$M,D=i.weekdays,$=i.months,N=i.meridiem,T=function(S,x,L,U){return S&&(S[x]||S(l,c))||L[x].slice(0,U)},I=function(S){return f.s(v%12||12,S,"0")},R=N||function(S,x,L){var U=S<12?"AM":"PM";return L?U.toLowerCase():U};return c.replace(ct,(function(S,x){return x||(function(L){switch(L){case"YY":return String(l.$y).slice(-2);case"YYYY":return f.s(l.$y,4,"0");case"M":return b+1;case"MM":return f.s(b+1,2,"0");case"MMM":return T(i.monthsShort,b,$,3);case"MMMM":return T($,b);case"D":return l.$D;case"DD":return f.s(l.$D,2,"0");case"d":return String(l.$W);case"dd":return T(i.weekdaysMin,l.$W,D,2);case"ddd":return T(i.weekdaysShort,l.$W,D,3);case"dddd":return D[l.$W];case"H":return String(v);case"HH":return f.s(v,2,"0");case"h":return I(1);case"hh":return I(2);case"a":return R(v,y,!0);case"A":return R(v,y,!1);case"m":return String(y);case"mm":return f.s(y,2,"0");case"s":return String(l.$s);case"ss":return f.s(l.$s,2,"0");case"SSS":return f.s(l.$ms,3,"0");case"Z":return u}return null})(S)||u.replace(":","")}))},o.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},o.diff=function(n,l,i){var c,u=this,v=f.p(l),y=w(n),b=(y.utcOffset()-this.utcOffset())*t,D=this-y,$=function(){return f.m(u,y)};switch(v){case M:c=$()/12;break;case p:c=$();break;case Y:c=$()/3;break;case k:c=(D-b)/6048e5;break;case m:c=(D-b)/864e5;break;case g:c=D/e;break;case h:c=D/t;break;case r:c=D/s;break;default:c=D}return i?c:f.a(c)},o.daysInMonth=function(){return this.endOf(p).$D},o.$locale=function(){return A[this.$L]},o.locale=function(n,l){if(!n)return this.$L;var i=this.clone(),c=F(n,l,!0);return c&&(i.$L=c),i},o.clone=function(){return f.w(this.$d,this)},o.toDate=function(){return new Date(this.valueOf())},o.toJSON=function(){return this.isValid()?this.toISOString():null},o.toISOString=function(){return this.$d.toISOString()},o.toString=function(){return this.$d.toUTCString()},d})(),nt=P.prototype;return w.prototype=nt,[["$ms",a],["$s",r],["$m",h],["$H",g],["$W",m],["$M",p],["$y",M],["$D",E]].forEach((function(d){nt[d[1]]=function(o){return this.$g(o,d[0],d[1])}})),w.extend=function(d,o){return d.$i||(d(o,P,w),d.$i=!0),w},w.locale=F,w.isDayjs=K,w.unix=function(d){return w(1e3*d)},w.en=A[O],w.Ls=A,w.p={},w}))});var B=bt(it(),1);function _(s){if(!s)return null;if(B.default.isDayjs(s))return s.startOf("day");let t=(0,B.default)(s);return t.isValid()?t.startOf("day"):(console.warn("Invalid date input:",s),null)}function C(s){let t=_(s);return t?t.format("YYYY-MM-DD"):""}function q(){return(0,B.default)().startOf("day")}function Q(s,t){let e=_(s),a=_(t);if(!e||!a||!e.isValid()||!a.isValid())return console.warn("Invalid date range:",s,t),[];let[r,h]=e.isAfter(a)?[a,e]:[e,a],g=[],m=r;for(;!m.isAfter(h);)g.push(m.format("YYYY-MM-DD")),m=m.add(1,"day");return g}function st(s,t){let e=C(s);return t.includes(e)}var H=class{constructor(t){this.form=t,this.validationType=this.form.dataset.validation,this.today=q()}validateDate(t){try{let e=_(t);if(!e)return{valid:!1,reason:"Invalid date format"};switch(this.validationType){case"future":return this.validateFuture(e);case"past":return this.validatePast(e);case"range":return this.validateRange(e);case"year":return this.validateYear(e);case"custom":return this.validateCustomRange(e);case"weekdays":return this.validateWeekdays(e);case"weekends":return this.validateWeekends(e);case"days":return this.validateSpecificDays(e);case"blackout":return this.validateBlackout(e);case"advance-notice":return this.validateAdvanceNotice(e);case"booking-window":return this.validateBookingWindow(e);case"business":return this.validateBusinessRules(e);case"none":default:return{valid:!0,reason:""}}}catch{return{valid:!1,reason:"Date parsing error"}}}validateFuture(t){return t.isBefore(this.today)?{valid:!1,reason:"Only future dates are allowed"}:{valid:!0,reason:""}}validatePast(t){return t.isAfter(this.today)?{valid:!1,reason:"Only past dates are allowed"}:{valid:!0,reason:""}}validateRange(t){let e=this.form.dataset.rangeStart?_(this.form.dataset.rangeStart):null,a=this.form.dataset.rangeEnd?_(this.form.dataset.rangeEnd):null;return!e&&!a?{valid:!1,reason:"Range validation requires start or end date"}:e&&t.isBefore(e)?{valid:!1,reason:`Date must be after ${this.formatDate(e)}`}:a&&t.isAfter(a)?{valid:!1,reason:`Date must be before ${this.formatDate(a)}`}:{valid:!0,reason:""}}validateYear(t){let e=parseInt(this.form.dataset.year);return e?t.year()===e?{valid:!0,reason:""}:{valid:!1,reason:`Only dates in ${e} are allowed`}:{valid:!1,reason:"Year validation requires data-year attribute"}}validateCustomRange(t){let e=this.form.dataset.minDate?_(this.form.dataset.minDate):null,a=this.form.dataset.maxDate?_(this.form.dataset.maxDate):null;return e&&t.isBefore(e)?{valid:!1,reason:`Date must be after ${this.formatDate(e)}`}:a&&t.isAfter(a)?{valid:!1,reason:`Date must be before ${this.formatDate(a)}`}:{valid:!0,reason:""}}validateWeekdays(t){let e=t.day();return e>=1&&e<=5?{valid:!0,reason:""}:{valid:!1,reason:"Only weekdays are allowed"}}validateWeekends(t){let e=t.day();return e===0||e===6?{valid:!0,reason:""}:{valid:!1,reason:"Only weekends are allowed"}}validateSpecificDays(t){let e=this.form.dataset.allowedDays?.split(",").map(g=>parseInt(g.trim()));if(!e||e.length===0)return{valid:!1,reason:"No allowed days specified"};let a=t.day();if(e.includes(a))return{valid:!0,reason:""};let r=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];return{valid:!1,reason:`Only ${e.map(g=>r[g]).join(", ")} are allowed`}}validateBlackout(t){let e=this.form.dataset.blackoutDates?.split(",").map(h=>h.trim())||[],a=this.form.dataset.blackoutRanges?.split(",").map(h=>h.trim())||[],r=C(t);if(e.includes(r))return{valid:!1,reason:"Date is not available"};for(let h of a){let[g,m]=h.split(":");if(g&&m){let k=_(g),p=_(m);if(!t.isBefore(k)&&!t.isAfter(p))return{valid:!1,reason:"Date is in blackout period"}}}return{valid:!0,reason:""}}validateAdvanceNotice(t){let e=parseInt(this.form.dataset.minAdvanceDays)||0,a=this.today.add(e,"day");return t.isBefore(a)?{valid:!1,reason:`Requires ${e} days advance notice`}:{valid:!0,reason:""}}validateBookingWindow(t){let e=parseInt(this.form.dataset.maxAdvanceDays)||365,a=this.today.add(e,"day");return t.isAfter(a)?{valid:!1,reason:`Cannot book more than ${e} days in advance`}:{valid:!0,reason:""}}validateBusinessRules(t){let e=this.validateAdvanceNotice(t);if(!e.valid)return e;let a=this.validateBookingWindow(t);if(!a.valid)return a;let r=this.validateSpecificDays(t);return r.valid?{valid:!0,reason:""}:r}needsRevalidation(){return this.form.dataset.maxSelections||this.validationType==="consecutive"}formatDate(t){return new Intl.DateTimeFormat("en-GB",{day:"numeric",month:"long",year:"numeric"}).format(t.toDate())}};function X(s,t){let e=s.closest(".dgwltd-calendar__day"),a=e.querySelector(".govuk-checkboxes__label");s.disabled=!0,s.setAttribute("aria-describedby",s.id+"-disabled-reason"),e.classList.add("dgwltd-calendar__day--disabled");let r=e.querySelector(".dgwltd-calendar__disabled-reason");r||(r=document.createElement("span"),r.className="dgwltd-calendar__disabled-reason govuk-visually-hidden",r.id=s.id+"-disabled-reason",e.appendChild(r)),r.textContent=t,a.setAttribute("title",t)}function tt(s){let t=s.closest(".dgwltd-calendar__day"),e=t.querySelector(".govuk-checkboxes__label"),a=t.querySelector(".dgwltd-calendar__disabled-reason");s.disabled=!1,s.removeAttribute("aria-describedby"),t.classList.remove("dgwltd-calendar__day--disabled"),a&&a.remove(),e.removeAttribute("title")}function W(s,t){t.forEach(e=>{let a=s.validateDate(e.value);a.valid?tt(e):X(e,a.reason)})}var j=class{constructor(t,e){this.form=t,this.validator=e,this.lastSelectedDate=null,this.isRangeMode=!1,this.previewRange=[],this.elements=this.cacheElements(),this.init()}cacheElements(){return{checkboxes:this.form.querySelectorAll('input[name="selected_dates[]'),hint:this.form.querySelector("#calendar-hint")}}init(){this.elements.checkboxes.forEach(t=>{t.addEventListener("click",e=>this.handleDateClick(e,t)),t.addEventListener("mouseenter",e=>this.handleDateHover(e,t)),t.addEventListener("mouseleave",()=>this.clearRangePreview())}),this.boundExitHandler=this.handleOutsideClick.bind(this),document.addEventListener("click",this.boundExitHandler)}handleOutsideClick(t){this.form.contains(t.target)||this.exitRangeMode()}destroy(){document.removeEventListener("click",this.boundExitHandler)}handleDateClick(t,e){if(e.disabled)return t.preventDefault(),!1;let a=_(e.value);if(this.isRangeMode&&this.lastSelectedDate){this.selectDateRange(this.lastSelectedDate,a,e),this.exitRangeMode();return}e.checked?(this.lastSelectedDate=a,this.isRangeMode=!0,this.showRangeStartFeedback(e)):this.exitRangeMode()}handleDateHover(t,e){if(!this.isRangeMode||!this.lastSelectedDate||e.disabled)return;let a=_(e.value);this.showRangePreview(this.lastSelectedDate,a)}selectDateRange(t,e){t.isAfter(e)&&([t,e]=[e,t]);let a=new Set(Q(t,e)),r=0;this.elements.checkboxes.forEach(h=>{a.has(h.value)&&!h.disabled&&(this.setCheckboxSelected(h),r++)}),this.clearRangePreview()}setCheckboxSelected(t){t.checked=!0,t.setAttribute("checked","checked"),t.dispatchEvent(new Event("change",{bubbles:!0}))}showRangePreview(t,e){this.clearRangePreview(),t.isAfter(e)&&([t,e]=[e,t]);let a=Q(t,e);this.form.querySelectorAll('input[name="selected_dates[]"]').forEach(h=>{let g=h.value;st(g,a)&&!h.disabled&&h.closest(".dgwltd-calendar__day").classList.add("dgwltd-calendar__day--preview-range")}),this.previewRange=a}clearRangePreview(){this.form.querySelectorAll(".dgwltd-calendar__day--preview-range").forEach(e=>{e.classList.remove("dgwltd-calendar__day--preview-range")}),this.previewRange=[]}showRangeStartFeedback(t){t.closest(".dgwltd-calendar__day").classList.add("dgwltd-calendar__day--range-start"),this.showRangeInstruction()}showRangeInstruction(){let t=this.form.querySelector(".dgwltd-calendar__range-instruction");t&&t.remove();let e=document.createElement("div");e.className="dgwltd-calendar__range-instruction",e.setAttribute("role","status"),e.textContent="Range start selected. Click another date to complete the range.";let a=this.form.querySelector("#calendar-hint");a&&a.appendChild(e)}exitRangeMode(){this.isRangeMode=!1,this.lastSelectedDate=null,this.clearRangePreview(),this.clearRangeStartFeedback(),this.clearRangeInstruction()}clearRangeStartFeedback(){this.form.querySelectorAll(".dgwltd-calendar__day--range-start").forEach(e=>{e.classList.remove("dgwltd-calendar__day--range-start")})}clearRangeInstruction(){let t=this.form.querySelector(".dgwltd-calendar__range-instruction");t&&t.remove()}};function ot(s){let t=s.querySelector("#calendar-hint");if(t){let e=document.createElement("div");e.className="dgwltd-calendar__range-hint",e.innerHTML='<div class="govuk-phase-banner"><p class="govuk-phase-banner__content"><strong class="govuk-tag govuk-phase-banner__content__tag">Tip</strong> <span class="govuk-phase-banner__text">Click two dates to select a date range</span></p></div>',t.appendChild(e)}}var V=class{constructor(t,e){this.form=t,this.validator=e,this.today=q(),this.init()}init(){this.addNavigationControls(),this.addKeyboardShortcuts()}addNavigationControls(){let t=this.form.querySelector(".govuk-pagination");if(!t)return;let e=document.createElement("div");e.className="dgwltd-calendar__quick-nav";let a=document.createElement("div");a.className="govuk-button-group";let r=this.createTodayButton();a.appendChild(r);let h=this.createNextAvailableButton();a.appendChild(h),e.appendChild(a);let g=this.createShortcutsHint();e.appendChild(g),t.parentNode.insertBefore(e,t)}createTodayButton(){let t=document.createElement("button");return t.type="button",t.className="govuk-button govuk-button--secondary dgwltd-calendar__today-btn",t.textContent="Jump to Today",t.setAttribute("title","Navigate to current month and highlight today"),t.addEventListener("click",e=>{e.preventDefault(),this.jumpToToday()}),t}createNextAvailableButton(){let t=document.createElement("button");return t.type="button",t.className="govuk-button govuk-button--secondary dgwltd-calendar__next-available-btn",t.textContent="Next Available",t.setAttribute("title","Find and navigate to next available date"),t.addEventListener("click",e=>{e.preventDefault(),this.findNextAvailableDate()}),t}createShortcutsHint(){let t=document.createElement("div");return t.className="dgwltd-calendar__shortcuts-hint",t.innerHTML="<small><strong>Shortcuts:</strong> T = Today, N = Next Available</small>",t}addKeyboardShortcuts(){document.addEventListener("keydown",t=>{if(this.form.contains(document.activeElement)&&!(t.target.tagName==="INPUT"&&t.target.type==="text"))switch(t.key.toLowerCase()){case"t":t.preventDefault(),this.jumpToToday();break;case"n":t.preventDefault(),this.findNextAvailableDate();break;case"arrowleft":t.preventDefault(),this.navigateToPreviousMonth();break;case"arrowright":t.preventDefault(),this.navigateToNextMonth();break}})}jumpToToday(){let t=this.getCurrentMonthFromUrl(),e=this.getCurrentYearFromUrl(),a=this.today.month()+1,r=this.today.year();t!==a||e!==r?this.navigateToMonth(r,a):this.highlightToday(),this.showNavigationFeedback(`Navigated to ${this.formatDate(this.today)}`)}findNextAvailableDate(){let t=this.findNextValidDate();if(t){let e=t.month()+1,a=t.year(),r=this.getCurrentMonthFromUrl(),h=this.getCurrentYearFromUrl();if(r!==e||h!==a){let g=C(t),m=this.addHighlightParam(this.buildNavigationUrl(a,e),g);window.location.href=m}else this.highlightDate(t),this.showNavigationFeedback(`Next available date: ${this.formatDate(t)}`)}else this.showNavigationFeedback("No available dates found in the next 365 days","error")}findNextValidDate(){let t=this.today.add(1,"day");for(let e=0;e<365;e++){let a=C(t);if(this.validator.validateDate(a).valid)return t;t=t.add(1,"day")}return null}highlightToday(){let t=C(this.today),e=this.form.querySelector(`input[value="${t}"]`);e&&this.highlightCheckbox(e,"today")}highlightDate(t){let e=C(t),a=this.form.querySelector(`input[value="${e}"]`);a&&(this.highlightCheckbox(a,"next-available"),a.scrollIntoView({behavior:"smooth",block:"center"}))}highlightCheckbox(t,e){let a=t.closest(".dgwltd-calendar__day");a.classList.remove("dgwltd-calendar__day--highlight");let r="dgwltd-calendar__day--highlight";a.classList.add(r),setTimeout(()=>{a.classList.remove(r)},3e3)}navigateToPreviousMonth(){let t=this.getCurrentMonthFromUrl(),e=this.getCurrentYearFromUrl(),a=t-1,r=e;a<1&&(a=12,r=e-1),this.navigateToMonth(r,a)}navigateToNextMonth(){let t=this.getCurrentMonthFromUrl(),e=this.getCurrentYearFromUrl(),a=t+1,r=e;a>12&&(a=1,r=e+1),this.navigateToMonth(r,a)}navigateToMonth(t,e){let a=this.buildNavigationUrl(t,e);window.location.href=a}buildNavigationUrl(t,e){let a=this.removeQueryParams(window.location.href,["cal_month","cal_year","highlight"]),r=a.includes("?")?"&":"?";return`${a}${r}cal_year=${t}&cal_month=${e}`}addHighlightParam(t,e){let a=t.includes("?")?"&":"?";return`${t}${a}highlight=${e}`}getCurrentMonthFromUrl(){let t=new URLSearchParams(window.location.search);return parseInt(t.get("cal_month"))||new Date().getMonth()+1}getCurrentYearFromUrl(){let t=new URLSearchParams(window.location.search);return parseInt(t.get("cal_year"))||new Date().getFullYear()}removeQueryParams(t,e){let a=new URL(t);return e.forEach(r=>{a.searchParams.delete(r)}),a.toString()}showNavigationFeedback(t,e="info"){let a=this.form.querySelector(".dgwltd-calendar__nav-feedback");a&&a.remove();let r=document.createElement("div");r.className=`dgwltd-calendar__nav-feedback dgwltd-calendar__nav-feedback--${e}`,r.setAttribute("role","status"),r.textContent=t;let h=this.form.querySelector("#calendar-hint");h&&h.appendChild(r),setTimeout(()=>{r.parentNode&&r.remove()},3e3)}formatDate(t){return new Intl.DateTimeFormat("en-GB",{weekday:"long",day:"numeric",month:"long",year:"numeric"}).format(t.toDate())}};function lt(s){let e=new URLSearchParams(window.location.search).get("highlight");if(e){let a=s.querySelector(`input[value="${e}"]`);if(a){let r=a.closest(".dgwltd-calendar__day");r.classList.add("dgwltd-calendar__day--highlight"),a.scrollIntoView({behavior:"smooth",block:"center"}),setTimeout(()=>{r.classList.remove("dgwltd-calendar__day--highlight")},5e3)}}}var Dt={unavailable_dates:["2025-09-16","2025-09-20","2025-09-25","2025-12-25","2025-01-01"]},z=class{constructor(t,e){this.form=t,this.validator=e,this.apiEndpoint=this.form.dataset.apiEndpoint}async init(){try{let t=await this.fetchUnavailableDates();this.applyBlackoutDates(t.unavailable_dates||[])}catch(t){console.warn("Calendar API failed, using fallback:",t)}}async fetchUnavailableDates(){return Promise.resolve(Dt)}applyBlackoutDates(t){if(!t||t.length===0)return;let e=this.form.dataset.blackoutDates||"",a=e?e.split(",").map(g=>g.trim()):[],r=[...new Set([...a,...t])];this.form.dataset.blackoutDates=r.join(","),this.form.dataset.validation||(this.form.dataset.validation="blackout");let h=this.form.querySelectorAll('input[name="selected_dates[]"]');W(this.validator,h),console.log("\u2705 Applied blackout dates from API:",r)}};document.addEventListener("DOMContentLoaded",function(){let s=document.querySelector(".dgwltd-calendar__form");if(!s)return;let t=new H(s),e=s.querySelectorAll('input[name="selected_dates[]"]');e.forEach(p=>{let Y=t.validateDate(p.value);Y.valid?tt(p):X(p,Y.reason)});let a=s.dataset.rangeSelection==="true",r=null;a&&(r=new j(s,t),ot(s));let h=s.dataset.navigation==="true",g=null;h&&(g=new V(s,t)),lt(s);let m=s.dataset.apiEnabled==="true",k=null;m&&(k=new z(s,t),k.init()),s.addEventListener("change",function(){t.needsRevalidation()&&W(t,e)}),console.log("\u2705 Enhanced Calendar System initialized:",{validation:t.validationType,rangeSelection:a,navigation:h,apiIntegration:m,totalDates:e.length,validDates:Array.from(e).filter(p=>!p.disabled).length})});})();
