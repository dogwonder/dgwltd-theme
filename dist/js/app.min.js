(()=>{function I(){return typeof HTMLButtonElement<"u"&&"command"in HTMLButtonElement.prototype&&"source"in((globalThis.CommandEvent||{}).prototype||{})}function q(){document.addEventListener("invoke",n=>{n.type=="invoke"&&n.isTrusted&&(n.stopImmediatePropagation(),n.preventDefault())},!0),document.addEventListener("command",n=>{n.type=="command"&&n.isTrusted&&(n.stopImmediatePropagation(),n.preventDefault())},!0);function c(n,r,o=!0){Object.defineProperty(n,r,{...Object.getOwnPropertyDescriptor(n,r),enumerable:o})}function e(n){return n&&typeof n.getRootNode=="function"?n.getRootNode():n&&n.parentNode?e(n.parentNode):n}let t=new WeakMap,i=new WeakMap;class s extends Event{constructor(r,o={}){super(r,o);let{source:u,command:p}=o;if(u!=null&&!(u instanceof Element))throw new TypeError("source must be an element");t.set(this,u||null),i.set(this,p!==void 0?String(p):"")}get[Symbol.toStringTag](){return"CommandEvent"}get source(){if(!t.has(this))throw new TypeError("illegal invocation");let r=t.get(this);if(!(r instanceof Element))return null;let o=e(r);return o!==e(this.target||document)?o.host:r}get command(){if(!i.has(this))throw new TypeError("illegal invocation");return i.get(this)}get action(){throw new Error("CommandEvent#action was renamed to CommandEvent#command")}get invoker(){throw new Error("CommandEvent#invoker was renamed to CommandEvent#source")}}c(s.prototype,"source"),c(s.prototype,"command");class b extends Event{constructor(r,o={}){throw super(r,o),new Error("InvokeEvent has been deprecated, it has been renamed to `CommandEvent`")}}let d=new WeakMap;function a(n){Object.defineProperties(n.prototype,{commandForElement:{enumerable:!0,configurable:!0,set(r){if(this.hasAttribute("invokeaction"))throw new TypeError("Element has deprecated `invokeaction` attribute, replace with `command`");if(this.hasAttribute("invoketarget"))throw new TypeError("Element has deprecated `invoketarget` attribute, replace with `commandfor`");if(r===null)this.removeAttribute("commandfor"),d.delete(this);else if(r instanceof Element){this.setAttribute("commandfor","");let o=e(r);e(this)===o||o===this.ownerDocument?d.set(this,r):d.delete(this)}else throw new TypeError("commandForElement must be an element or null")},get(){if(this.localName!=="button")return null;if(this.hasAttribute("invokeaction")||this.hasAttribute("invoketarget"))return console.warn("Element has deprecated `invoketarget` or `invokeaction` attribute, use `commandfor` and `command` instead"),null;if(this.disabled)return null;if(this.form&&this.getAttribute("type")!=="button")return console.warn("Element with `commandFor` is a form participant. It should explicitly set `type=button` in order for `commandFor` to work"),null;let r=d.get(this);if(r)return r.isConnected?r:(d.delete(this),null);let o=e(this),u=this.getAttribute("commandfor");return(o instanceof Document||o instanceof ShadowRoot)&&u&&o.getElementById(u)||null}},command:{enumerable:!0,configurable:!0,get(){let r=this.getAttribute("command")||"";if(r.startsWith("--"))return r;let o=r.toLowerCase();switch(o){case"show-modal":case"close":case"toggle-popover":case"hide-popover":case"show-popover":return o}return""},set(r){this.setAttribute("command",r)}},invokeAction:{enumerable:!1,configurable:!0,get(){throw new Error("invokeAction is deprecated. It has been renamed to command")},set(r){throw new Error("invokeAction is deprecated. It has been renamed to command")}},invokeTargetElement:{enumerable:!1,configurable:!0,get(){throw new Error("invokeTargetElement is deprecated. It has been renamed to command")},set(r){throw new Error("invokeTargetElement is deprecated. It has been renamed to command")}}})}let h=new WeakMap;Object.defineProperties(HTMLElement.prototype,{oncommand:{enumerable:!0,configurable:!0,get(){return m.takeRecords(),h.get(this)||null},set(n){let r=h.get(this)||null;r&&this.removeEventListener("command",r),h.set(this,typeof n=="object"||typeof n=="function"?n:null),typeof n=="function"&&this.addEventListener("command",n)}}});function l(n){for(let r of n)r.oncommand=new Function("event",r.getAttribute("oncommand"))}let m=new MutationObserver(n=>{for(let r of n){let{target:o}=r;r.type==="childList"?l(o.querySelectorAll("[oncommand]")):l([o])}});m.observe(document,{subtree:!0,childList:!0,attributeFilter:["oncommand"]}),l(document.querySelectorAll("[oncommand]"));function w(n){if(n.defaultPrevented||n.type!=="click")return;let r=n.target.closest("button[invoketarget], button[invokeaction], input[invoketarget], input[invokeaction]");if(r&&(console.warn("Elements with `invoketarget` or `invokeaction` are deprecated and should be renamed to use `commandfor` and `command` respectively"),r.matches("input")))throw new Error("Input elements no longer support `commandfor`");let o=n.target.closest("button[commandfor], button[command]");if(!o)return;if(o.form&&o.getAttribute("type")!=="button")throw n.preventDefault(),new Error("Element with `commandFor` is a form participant. It should explicitly set `type=button` in order for `commandFor` to work. In order for it to act as a Submit button, it must not have command or commandfor attributes");if(o.hasAttribute("command")!==o.hasAttribute("commandfor")){let f=o.hasAttribute("command")?"command":"commandfor",E=o.hasAttribute("command")?"commandfor":"command";throw new Error(`Element with ${f} attribute must also have a ${E} attribute to function.`)}if(o.command!=="show-popover"&&o.command!=="hide-popover"&&o.command!=="toggle-popover"&&o.command!=="show-modal"&&o.command!=="close"&&!o.command.startsWith("--")){console.warn(`"${o.command}" is not a valid command value. Custom commands must begin with --`);return}let u=o.commandForElement;if(!u)return;let p=new s("command",{command:o.command,source:o,cancelable:!0});if(u.dispatchEvent(p),p.defaultPrevented)return;let g=p.command.toLowerCase();if(u.popover){let f=!u.matches(":popover-open");f&&(g==="toggle-popover"||g==="show-popover")?u.showPopover({source:o}):!f&&g==="hide-popover"&&u.hidePopover()}else if(u.localName==="dialog"){let f=!u.hasAttribute("open");f&&g==="show-modal"?u.showModal():!f&&g==="close"&&u.close()}}function v(n){n.addEventListener("click",w,!0)}function y(n,r){let o=n.prototype.attachShadow;n.prototype.attachShadow=function(p){let g=o.call(this,p);return r(g),g};let u=n.prototype.attachInternals;n.prototype.attachInternals=function(){let p=u.call(this);return p.shadowRoot&&r(p.shadowRoot),p}}a(HTMLButtonElement),y(HTMLElement,n=>{v(n),m.observe(n,{attributeFilter:["oncommand"]}),l(n.querySelectorAll("[oncommand]"))}),v(document),Object.assign(globalThis,{CommandEvent:s,InvokeEvent:b})}I()||q();var S=class extends HTMLElement{constructor(){super()}get url(){return this.getAttribute("url")||window.location.href}get title(){return this.getAttribute("title")||document.title}get description(){let e=document.querySelector('meta[name="description"]');return e?e.getAttribute("content"):""}get hasShareSupport(){return navigator.share}get hasClipboardSupport(){return navigator.clipboard}triggerShare(e){navigator.share({title:this.title,url:this.url,text:this.description}).then(()=>{this.renderAlert("Thanks!",e)}).catch(t=>console.error("Error sharing",t))}copyToClipboard(e){navigator.clipboard.writeText(this.url).then(()=>{this.renderAlert("Copied!",e)}).catch(t=>console.error(t))}renderAlert(e,t,i=3e3){let s=t?t.nextElementSibling:this.querySelector('[role="alert"]');s&&(s.innerText=e,setTimeout(()=>{s.innerText=""},i))}handleClick(e){switch(e.currentTarget.dataset.method){case"share":this.triggerShare(e.currentTarget);return;case"clipboard":this.copyToClipboard(e.currentTarget);return}}assignEvents(){let e=this.querySelectorAll("button");e.length&&e.forEach(t=>t.addEventListener("click",i=>this.handleClick(i)))}connectedCallback(){if(!this.hasShareSupport&&!this.hasClipboardSupport){console.log("No support so revert to MVE");return}this.innerHTML=`
        <ul class="dgwltd-share-actions cluster" role="list">
          ${this.hasShareSupport?`
            <li>
              <button class="button" data-method="share">Share</button>
              <div role="alert"></div>
            </li>
          `:""}
          ${this.hasClipboardSupport?`
            <li>
              <button class="button" data-method="clipboard">Copy URL</button>
              <div role="alert"></div>
            </li>
          `:""}
        </ul>
  
      `,this.assignEvents()}};customElements.define("share-actions",S);var A=class{constructor(e){this.element=e,this.currentIntensity=parseInt(e.getAttribute("current-intensity"))||150,this.init()}init(){this.setLevel(),this.render()}setLevel(){this.currentIntensity<100?this.level="low":this.currentIntensity<=250?this.level="moderate":this.level="high"}render(){this.element.innerHTML=`
      <div class="carbon-intensity-bar dgwltd-body-xs" data-level="${this.level}">
        <div class="carbon-intensity-content">
          <span class="carbon-intensity-value">Grid intensity: ${this.currentIntensity}</span>
          <span class="carbon-intensity-unit">gCO2/kWh</span>
          <span class="carbon-intensity-level">(${this.level})</span>
        </div>
        <div class="carbon-intensity-indicator" style="--intensity-value: ${this.currentIntensity}"></div>
      </div>
    `,this.element.setAttribute("data-gaw-level",this.level),this.element.setAttribute("data-gaw-location","GB"),this.element.setAttribute("data-gaw-intensity",this.currentIntensity)}},k=class{constructor(e){this.element=e,this.generationData=this.parseGenerationData(e.getAttribute("generation-data")),this.init()}init(){this.processData(),this.render()}parseGenerationData(e){try{let t=e.replace(/&quot;/g,'"').replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">");return JSON.parse(t)}catch(t){return console.warn("Failed to parse generation data:",t),[]}}processData(){this.filteredMix=this.generationData.filter(t=>t.perc>0).sort((t,i)=>i.perc-t.perc);let e=["wind","solar","hydro"];this.renewablePercentage=this.filteredMix.filter(t=>e.includes(t.fuel)).reduce((t,i)=>t+i.perc,0),this.mixData=this.filteredMix.map(t=>`${t.fuel}:${t.perc}`).join(",")}render(){let e={wind:"#9bdb5e",solar:"#eedc30",nuclear:"#189aca",gas:"#ec994d",coal:"#000000",biomass:"#8b4513",hydro:"#0066cc",imports:"#555555",other:"#cccccc"},t=0,i=this.filteredMix.map((s,b)=>{let d=b===0?`${s.perc}+`:`${s.perc}_${t.toFixed(1)}+`,a=`<span data-fuel="${s.fuel}" aria-label="${s.fuel}: ${s.perc}%" style="--fuel-color: ${e[s.fuel]||"#cccccc"}; --fuel-percentage: ${s.perc}; --cumulative-percentage: ${t}">${d}</span>`;return t+=s.perc,a}).join("");this.element.innerHTML=`
    <div class="power-mix-container">
      <div class="dgwltd-chart" role="img" aria-label="UK power generation mix">
        ${i}<span class="chart-ring">+x20</span>
      </div>
      <div class="dgwltd-body-xs">
        <span class="renewable-percentage">${Math.round(this.renewablePercentage)}% renewable</span>
      </div>
    </div>
  `,this.element.setAttribute("data-gaw-location","UK"),this.element.setAttribute("data-gaw-mix",this.mixData),this.element.setAttribute("data-renewable-percentage",Math.round(this.renewablePercentage))}};function L(){document.querySelectorAll("carbon-intensity").forEach(c=>{new A(c)}),document.querySelectorAll("power-mix").forEach(c=>{new k(c)})}document.addEventListener("DOMContentLoaded",L);var T=992,M=()=>{document.querySelectorAll('a[rel="external"]').forEach(c=>{c.addEventListener("click",e=>{e.preventDefault(),window.open(c.href)})})},H=()=>{document.querySelectorAll('.scroll[href^="#"]').forEach(c=>{c.addEventListener("click",e=>{e.preventDefault(),c.getAttribute("href")!=="#"&&document.querySelector(c.getAttribute("href")).scrollIntoView({behavior:"smooth"})})})},$=(c,e,t)=>{let i=document.querySelector(c);if(!i)return;let s=document.querySelector(e),b=document.querySelector(t);window.subscribers=[];let d={status:"closed",enabled:!1},a=new Proxy(d,{set(l,m,w){let v={...l};return l[m]=w,window.subscribers.forEach(y=>y(l,v)),l}});new ResizeObserver(([{contentRect:l,target:m}])=>{a.enabled=l.width<=T,m.setAttribute("data-enabled",a.enabled)}).observe(b),i.addEventListener("click",()=>{let l=JSON.parse(i.getAttribute("aria-expanded"));a.status=l?"closed":"open",i.setAttribute("aria-expanded",!l),s.setAttribute("status",a.status),b.classList.toggle("masthead-is-open"),document.body.classList.toggle("nav-open"),document.documentElement.style.setProperty("--submenu-offset",s.offsetHeight+b.offsetHeight+"px")}),window.addEventListener("keydown",l=>{l.key.includes("Escape")&&(i.setAttribute("aria-expanded","false"),b.classList.remove("masthead-is-open"),document.body.classList.remove("nav-open"),a.status="closed",s.setAttribute("status",a.status))})},D=()=>{let c=document.getElementById("theme-switcher"),e=t=>{t==="light"?(document.documentElement.dataset.colorScheme="light",localStorage.setItem("mode","light"),document.getElementById("theme-light").checked=!0):t==="dark"?(document.documentElement.dataset.colorScheme="dark",localStorage.setItem("mode","dark"),document.getElementById("theme-dark").checked=!0):(delete document.documentElement.dataset.colorScheme,localStorage.removeItem("mode"),document.getElementById("theme-light").checked=!0)};c.classList.add("visible"),e(localStorage.getItem("mode")),document.getElementById("theme-light").addEventListener("click",()=>e("light")),document.getElementById("theme-dark").addEventListener("click",()=>e("dark"))},R=(c,e)=>{let t=document.querySelector(c);if(!t)return;let i=document.querySelector(e),s=t.querySelectorAll(".menu-item-has-children");new ResizeObserver(([{contentRect:d}])=>{s.forEach(a=>{let h=JSON.parse(a.querySelector("a").getAttribute("aria-expanded"));d.width>=T&&(a.addEventListener("mouseenter",()=>{document.querySelectorAll(".menu-open").forEach(l=>{l!==a&&(l.classList.remove("menu-open"),l.querySelector("a").setAttribute("aria-expanded","false"))}),a.querySelector("a").setAttribute("aria-expanded",!h),a.classList.toggle("menu-open"),a.querySelector(".sub-menu").removeAttribute("hidden"),document.body.classList.add("masthead-expanded")}),a.addEventListener("mouseleave",()=>{a.querySelector("a").setAttribute("aria-expanded","false"),a.classList.remove("menu-open"),a.querySelector(".sub-menu").setAttribute("hidden",""),document.body.classList.remove("masthead-expanded")}),window.addEventListener("keydown",l=>{l.key.includes("Escape")&&(document.body.classList.remove("masthead-expanded"),a.querySelector("a").setAttribute("aria-expanded","false"),a.classList.remove("menu-open"),a.querySelector(".sub-menu").setAttribute("hidden",""))}))})}).observe(i),s.forEach(d=>{let a=d.querySelector("a"),h=document.createElement("button");h.className="button-show-subnav",h.innerHTML=`<span>show sub menu for "${a.text}"</span>`,a.insertAdjacentElement("afterend",h),h.addEventListener("click",l=>{s.forEach(m=>{(m.classList.contains("current-menu-item")||m.classList.contains("current-menu-ancestor"))&&m.classList.remove("current-menu-item","current-menu-ancestor")}),d.classList.toggle("menu-open"),document.querySelectorAll(".menu-open").forEach(m=>{m!==d&&m.classList.remove("menu-open")}),d.classList.contains("menu-open")?(d.querySelector("a").setAttribute("aria-expanded","true"),h.setAttribute("aria-expanded","true"),d.querySelector(".sub-menu").removeAttribute("hidden")):(d.querySelector("a").setAttribute("aria-expanded","false"),h.setAttribute("aria-expanded","false"),d.querySelector(".sub-menu").setAttribute("hidden","")),l.preventDefault()})})},O=c=>{document.querySelectorAll(c).forEach(e=>{let t=e.querySelector(".dgwltd-card__link");t&&e.addEventListener("click",i=>{window.getSelection().toString()||(window.location=t.href)})})},x=class{constructor(e){document.querySelectorAll(e).forEach(t=>{t.setAttribute("rows",4),this.update(t)})}isScrolling(e){return e.scrollHeight>e.clientHeight}grow(e){let t=e.clientHeight,i=this.rows(e);for(;this.isScrolling(e);){i++,e.rows=i;let s=e.clientHeight;if(s===t)break;t=s}}shrink(e){let t=e.clientHeight,i=parseInt(e.dataset.minRows),s=this.rows(e);for(;!this.isScrolling(e)&&s>i&&(s--,e.rows=Math.max(s,i),e.clientHeight!==t);)if(this.isScrolling(e)){this.grow(e);break}}update(e){this.isScrolling(e)?this.grow(e):this.shrink(e)}rows(e){return e.rows||parseInt(e.dataset.minRows)}};document.addEventListener("DOMContentLoaded",()=>{M(),H(),$("#nav-toggle","#nav-primary","#masthead"),D(),R("#nav-primary","#masthead"),O(".dgwltd-card"),new x("textarea"),L()});})();
